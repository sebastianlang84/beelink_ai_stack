# Changelog

## Unreleased
- docs: Agent-Tagebuch nach `AGENTDIARY.md` im Repo-Root verschoben
- config: aktualisierte Open WebUI Knowledge-ID fuer Topic `investing` (Sync-Fehler durch stale Mapping behoben)
- mcp-transcript-miner: Knowledge-ID Mapping validiert (Fallback auf Name=Topic bei stale IDs)
- mcp-transcript-miner: Knowledge-Name Resolution ohne ID-Mapping konfiguriert (Mapping-Path geleert)
- transcript-miner: sofortiger per-Video Knowledge-Sync nach Summary-Write (optional via OPEN_WEBUI_SYNC_ON_SUMMARY)
- transcript-miner: per-summary Sync auch bei bereits vorhandenen Summaries (valid) und im Streaming-Worker
- transcript-miner: fix per-summary Sync bei vorhandenen Summaries (Default-Metadaten initialisiert)
- docs: Hinweis zu OWUI „Updated“ UI-Stamp (nicht zuverlässig bei File-Adds)
- docs: Prompt-Engineering Handover-Report (enhance_prompt_engineering.md) hinzugefuegt
- docs: Experten-Notizen fuer Prompt-Engineering (docs/prompt_engineering_expert_notes.md)
- docs: Investing-Test Workflow (Alpha) dokumentiert (investing_test fuer Prompt-Iterationen)
- docs: agent diary eingefuehrt (`AGENTDIARY.md`)
- agents: Tagebuch-Pflicht + Commit-Regeln in `AGENTS.md` verankert
- mcp-transcript-miner: Auto‑Sync läuft jetzt unabhängig vom Status‑Polling (Watcher‑Thread) und schreibt Sync‑Result/Errors in Run‑Status + Run‑Log
- mcp-transcript-miner: `sync/topic` heilt fehlende Summaries automatisch via LLM‑Only‑Run vor dem Indexing (optional steuerbar per Request)
- mcp-transcript-miner: proxy env vars (Webshare/generic) werden an Tool-Container durchgereicht
- transcript-miner: YouTube Block-Klassifikation korrigiert (Subtitles disabled ≠ IP-Block)
- transcript-miner: Proxy Quickcheck Tool (tools/proxy_quickcheck.py)
- transcript-miner: Streaming Summaries (opt-in) parallel zum Transcript-Download
- transcript-miner: Timing-Logs für Transcript-Downloads und per-video Summaries
- scripts: purge_topic_data.sh zum vollständigen Löschen eines Test-Topics (inkl. OWUI Knowledge)
- scripts: purge_topic_data.sh nutzt OWUI `/knowledge/{id}/delete` + Container-Fallback bei fehlendem python3/Permissions
- configs: analysis.llm.model auf google/gemini-3-flash-preview + reasoning_effort=high (Investing/Test/AI-Knowledge)
- transcript-miner: investing LLM prompt auf Schema v2 erweitert (stocks_mentioned/other_insights/numbers + Coverage-Regeln)
- transcript-miner: investing_test LLM prompt auf Schema v2 erweitert (stocks_mentioned/other_insights/numbers + Coverage-Regeln)
- transcript-miner: Report-Prompt rendert jetzt stocks_mentioned/numbers/other_insights (Investing + Test)
- transcript-miner: Validator akzeptiert Schema v2 + prüft stocks_mentioned/other_insights/numbers
- docs: LLM Prompt Spec um Schema v2 (stocks_per_video_extract) ergänzt
- docs: Use-Case Stocks auf Evidence/Confidence im Investing-Setup aktualisiert
- templates: report_stocks_{de,en} um Stocks Mentioned + Other Insights erweitert
- docs/templates/configs: Begriffe Creator/Influencer auf Channel vereinheitlicht (Investing Reports)
- reports: Quellenformat jetzt überall Channel + Video-Titel + Video-ID (Templates/Prompts/LLM-Report)
- config: Config-Template ergänzt OpenRouter Attribution (X-Title / HTTP-Referer)
- ci: md_link_audit als verpflichtender Doc-Link-Check integriert
- mcp-transcript-miner: Auto-Sync läuft jetzt auch bei Run-Exit != 0 (synct alle vorhandenen Summaries)
- transcript-miner: Per-Video Summary-Renderer zeigt jetzt stocks_mentioned/numbers/other_insights
- config: knowledge_ids.json entfernt investing_test Mapping (damit Test-Collection neu erzeugt werden kann)
- mcp-transcript-miner: OPEN_WEBUI_AUTO_SYNC_AFTER_RUN und OPEN_WEBUI_CREATE_KNOWLEDGE_IF_MISSING werden an den Container durchgereicht
- transcript-miner: IP-Block-Zähler in Run-Summary + sichtbare Meldung bei YouTube-Block (Run-Status)
- mcp-transcript-miner: fix _strip_frontmatter indentation regression
- transcript-miner: Summary-Regeneration bei Topic-Mismatch + Index filtert auf youtube.channels
- mcp-transcript-miner: auto-create Knowledge Collection option + besser benannte Upload-Dateien
- docs: knowledge_ids.json.example aktualisiert (ai_knowledge, investing, investing_test)
- mcp-transcript-miner: fix missing requests import in sync.topic
- ops: systemd Timer für investing-Run alle 3h (Auto-Sync nach Run)
- mcp-transcript-miner: optionaler Auto-Sync nach Run-Ende (OPEN_WEBUI_AUTO_SYNC_AFTER_RUN)
- mcp-transcript-miner: runs.start löst config_id über aliases aus configs.list auf
- scripts: openwebui_apply_tool_imports lädt .env automatisch für OPEN_WEBUI_API_KEY
- mcp-transcript-miner: Tool-Docs empfehlen summary statt log_path/log_tail in Antworten
- mcp-transcript-miner: youtube-transcript-api auf 1.2.3 aktualisiert (proxies Modul vorhanden)
- mcp-transcript-miner: runs.start/runs.status liefern `summary` (kurzer Klartext)
- mcp-transcript-miner: configs.list liefert display_name/aliases; Tool-Docs raten zu configs.list vor runs.start
- ops: Webshare als funktionierende Mitigation gegen YouTube 429 bestätigt
- docs: Knowledge-Name = Topic als No-Fuss Workflow dokumentiert
- docs: Runbook für YouTube Transcript 429 (Tests + Mitigation) ergänzt
- mcp-transcript-miner: Knowledge-ID Mapping optional; Sync löst Knowledge-ID per Name=Topic über OWUI API auf
- docs: Topic `stocks_crypto` überall auf `investing` umbenannt (Config/Template/Beispiele/Runbooks)
- backup: Output-Root Default auf `/home/wasti/ai_stack_data/transcript-miner/output` vereinheitlicht (Runbook + systemd + Scripts) + Hinweis zu root-owned Volume-Backups ergänzt
- docs: YouTube 429 als TODO erfasst (Runbook/Tests fuer stabile Fetch-Strategie)
- docs: YouTube 429 Einordnung/Workarounds/Alternativen im Block-Report ergaenzt
- docs: Report zum aktuellen YouTube Transcript Block (HTTP 429)
- transcript-miner: Downloader/Tools auf youtube-transcript-api v1 angepasst (list() API)
- transcript-miner: Proxy-Config (Webshare/Generic) reaktiviert + Env-Substitution fuer Proxy-Credentials
- transcript-miner: Globaler Proxy-Default via config_global.yaml + .config.env; Standard-User-Agent gesetzt
- transcript-miner: Tool `tools/youtube_block_probe.py` fuer systematische Rate-Limit Tests
- docs: Watchdog-Schwellwerte auf Intel N150 Kontext ergaenzt
- docs: Watchdog-Plan erweitert (PSI/Memory/Inodes/Schwellwerte/Trigger-Logik)
- watchdog: Temp-Schutz (>=60C bei 2 Messungen) stoppt konfigurierbare Container
- watchdog: `--once` CLI fuer sofortige Messung via stdout
- watchdog: Container-Name explizit auf `watchdog` gesetzt (abweichend von Standard-Compose-Naming)
- watchdog: Container fuer Host-Monitoring (CPU/Temperatur/Disk + Docker-Hygiene)
- docs: Watchdog-Plan fuer CPU/Temperatur/Disk Monitoring (`docs/plan_watchdog_monitoring.md`)
- transcript-miner: Tool ergänzt zur Reproduktion von Cookie-Load/Transcript-Request Fehlern (`tools/repro_cookie_load.py`)
- repo: `youtube_cookies.txt` gitignored (lokale Cookie-Datei für YouTube)
- transcript-miner: Fehler-History als JSONL unter `output/data/diagnostics/errors.jsonl` (append-only, ERROR+ aus der Pipeline)
- mcp-transcript-miner: Host-Data-Dir in Container gemountet, damit `output.global` Pfade (z. B. Fehler-History) persistent bleiben
- transcript-miner: Cookie-freie Rate-Limit-Strategie in `config_investing.yaml`/`config_ai_knowledge.yaml` + LLM-Concurrency=1; `config_wsl_optimized.yaml` mit konservativen (WSL/VPN) Delays ohne Cookies
- transcript-miner: README verweist auf cookie-freies WSL-Profil als Block-Mitigation
- transcript-miner: docs/config.md verweist auf cookie-freies WSL-Profil
- transcript-miner: docs/README.md listet cookie-freies WSL-Profil als Beispiel-Config
- transcript-miner: docs/README.md ergänzt Hinweis zu konservativen Delays im WSL-Profil
- transcript-miner: docs/plans/ip_block_solution.md auf cookie-freien Default + WSL-Profil aktualisiert
- ai_stack: `config/knowledge_ids.json` auf aktuelle Open WebUI Knowledge-IDs angepasst
- docs: Reindex-Runbook für Open WebUI Knowledge ohne Tool-Abhängigkeit präzisiert
- scripts: `check_tm_run_status.sh` zur Run-Diagnose (Status + Cookie-Check)
- TranscriptMiner: LLM-Validator erzwingt Macro/Crypto Tag-Taxonomie + Evidence-Rollen + Deep-Dive-Kriterium für `stocks_covered`
- TranscriptMiner: Logging-Setup robust gegen read-only Repo-Mounts (kein hardes `mkdir <PROJECT_ROOT>/logs`, wenn `logging.file` gesetzt ist)
- Secrets/Env: repo-local `.env` (secrets-only) + `.config.env`/`<service>/.config.env` (non-secrets), alles gitignored (keine Werte in Git)
- ai_stack: Smoke-Test Runbook + Script ergänzt (`docs/runbook_smoke_test.md`, `scripts/smoke_test_ai_stack.sh`)
- Naming/Compose: SSOT Naming v2 umgesetzt (Network bleibt `ai-stack`; Stacks `owui|tm|context6|qdrant`, Volumes `owui-data|tm-data|context6-{data,cache}|qdrant-data|emb-bench-cache`, Images `tm:latest`, `context6:latest`)
- mcp-transcript-miner: `.config.env.example` bereinigt (Knowledge-Mapping optional via `OPEN_WEBUI_KNOWLEDGE_ID_BY_TOPIC_JSON_PATH`; Host-Path-Overrides ergänzt)
- context6: `sources.create` robuster gemacht (GitHub akzeptiert jetzt auch `config.repo`/`config.url` und normalisiert auf `config.github.repo`)
- context6: `sources.create` aktualisiert bestehende Sources in-place (idempotent) und liefert zusätzlich `updated` zurück
- context6: Open WebUI Knowledge Create sendet immer `description` (fix für HTTP 422 bei Open WebUI 0.7.2)
- context6: Open WebUI Knowledge UX verbessert: neue Tools `sync.prepare`, `owui.knowledge.list`, `owui.knowledge.create` + `sync.start` unterstützt `knowledge_name`/`create_knowledge_if_missing` und `sync.status` liefert `knowledge_files_count` (best-effort)
- context6: Open WebUI Upload-Filenames sind jetzt sprechend (aus `canonical_path`) + Kurz-Hash statt nur `doc_id`
- context6: Open WebUI Knowledge `list` Response-Shape `{items:[...]}` unterstützt (damit `sync.prepare` / `owui.knowledge.list` nicht leer bleibt)
- Secrets: Redaction helper ergänzt (`scripts/redact_secrets_output.sh`) + Doku/Skill ergänzt „kein ungefiltertes `docker compose ... config` teilen“
- context6: Qdrant/OpenRouter Embeddings entfernt; Indexing erfolgt via Upload in Open WebUI Knowledge (Open WebUI übernimmt Processing/Embeddings)
- Projekt-Skills ergänzt: `skills/` (Codex Workflows für Compose-Validation, Secrets-Policy, Tool-Imports, Backup/Restore, etc.)
- Open WebUI Stack ergänzt: Compose + Doku, Image-Tag gepinnt (0.7.2), localhost-only Port `127.0.0.1:3000`
- Open WebUI External Tools: Import-JSON für Context7 MCP ergänzt (`open-webui/tool-imports/tool_import_context7.json`)
- Open WebUI Indexer in **Transcript Miner** integriert (ein Tool in Open WebUI): `mcp-transcript-miner/` (`POST /index/transcript`, `POST /sync/topic/{topic}`)
- TranscriptMiner Summaries vereinheitlicht: pro Video `*.summary.md` (kein `*.summary.json` mehr)
- Cleanup: redundante Stacks entfernt (kein separates `tool-owui-sync/`, kein `n8n/` im Repo)
- Workflow-Zielbild dokumentiert: Open WebUI Tool „hole die neuesten videos“ → TranscriptMiner → Knowledge (`docs/workflow_openwebui_hole_neueste_videos.md`)
- PRD v0 ergänzt: TranscriptMiner Sync Tool für Open WebUI (`docs/prd-tool-owui-transcript-miner-sync.md`)
- Doku-Netzwerk via `docs/README.md` eingeführt
- VPN access: Empfehlung/Runbook für Tailscale Serve (Tailnet-HTTPS vor localhost-only Services)
- Tool-Server ergänzt (FastAPI): `mcp-transcript-miner/` (YouTube Transcript HTTP Tool + Runs + Indexing)
- PRD ergänzt: `mcp-transcript-miner/PRD.md`
- Policy ergänzt (Docs): Secrets & Environment Variables (SSOT + Least Privilege)
- Runbook ergänzt (Docs): `.env` (secrets) + `.config.env`/`<service>/.config.env` (config) (inkl. Rechte/Start-Kommandos)
- Secrets-Hygiene: versehentliche Repo-`.env` entfernt; Compose nutzt nur noch explizite `--env-file` Secrets
- Backup/Restore Runbook + Scripts ergänzt (`docs/runbook_backup_restore.md`, `scripts/backup_*`)
- PRD ergänzt: Embedding Benchmark Suite (MRL Truncation + Local CPU vs OpenRouter Qwen3) (`docs/prd_embedding_benchmark_suite_mrl_local_vs_openrouter_qwen3.md`)
- Tool ergänzt: Embedding Benchmark Suite (Docker-first) unter `emb-bench/`
- PRD ergänzt: context6 (PoC/Prototype Working Draft) (`docs/prd_context6_poc_working_draft.md`)
- PoC implementiert: context6 MCP Server unter `mcp-context6/` (MCP `/mcp`, sources + sync + search/get)
- Transcript Miner Tool: MCP Streamable HTTP Endpoint (`POST /mcp`) + Import JSON (`open-webui/tool-imports/tool_import_transcript_miner_mcp.json`)
- emb-bench: Terminal Runner Script (`scripts/run_emb_bench.sh`)
- Qdrant Stack ergänzt: `qdrant/docker-compose.yml` (localhost-only `127.0.0.1:6333`)
- Qdrant Policy: Indexing-Schema für Collections/IDs/Payload (`docs/policy_qdrant_indexing.md`)
- Qdrant Compose: fehlerhaften Healthcheck entfernt (Image hat kein `python`/`curl`/`wget`; Host-Check via `curl /readyz`)
- Agents: „recherchiere“ = Context7-first Regel ergänzt (`AGENTS.md`)
- Indexing Notes: RooCode Scope-Steuerung via `.rooignore`/`.gitignore` dokumentiert + Template ergänzt (`docs/policy_qdrant_indexing.md`, `.rooignore.example`)
- Naming: MCP Server Ordner auf `mcp-*` umgestellt (`mcp-transcript-miner/`, `mcp-context6/`) + Tool-Imports/Docs aktualisiert
- Open WebUI: Tool-Imports zentralisiert (`open-webui/tool-imports/`) + Admin-API Script zum Setzen der Tool-Server ergänzt (`scripts/openwebui_apply_tool_imports.sh`)
- Open WebUI Tool Imports: `config: {}` ergänzt, damit `/api/v1/configs/tool_servers` nicht mit Response-Validation `500` crasht (Open WebUI 0.7.x)
